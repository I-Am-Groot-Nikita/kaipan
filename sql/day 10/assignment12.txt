Tables used:
===========
1) product (recid, mfrid, description, price, qtyonhand)

2) orders (recid, customerid, orderdate, salesrepsid, productid, qty, amount)

3) customer (recid, company, salesrepsid, creditlimit)

4) salesreps (recid, name, officeid, designation, hiredate, manager, quota, sales, age)

5) office (recid, city, region, manager, targetsales, actualsales)

product (productid, mfrid, description, price, qtyonhand)
orders (orderid, customerid, orderdate, salesrepsid, productid, qty, amount)
customer (customerid, company, salesrepsid, creditlimit)
salesreps (salesrepsid, name, officeid, designation, hiredate, manager, quota, sales, age)
office (officeid, city, region, manager, targetsales, actualsales)

Write queries for following requirements:


Q-1	List all the orders which are over Rs.25,000/- including the name of the sales person 	who has taken the order and the name of the customer who has placed that order.

select distinct o.orderid "Order", ts.name "Sales Person" , tc.company "Customer"
from trainee_35_orders o
inner join trainee_35_salesreps ts on o.salesrepsid = ts.salesrepsid
inner join trainee_35_customer tc on tc.salesrepsid = ts.salesrepsid 
where o.amount >= 25000;

select distinct o.orderid "Order", ts.name "Sales Person" , tc.company "Customer"
from trainee_35_orders o
inner join trainee_35_salesreps ts on o.salesrepsid = ts.salesrepsid
inner join trainee_35_customer tc on tc.salesrepsid = ts.salesrepsid
where o.amount >= 200;

Q-2	List out total different customers served by each sales person.

select s.name " Sales person", count(c.customerid) "Total Customers"
from trainee_35_customer c
inner join trainee_35_salesreps s on c.salesrepsid = s.salesrepsid 
group by s.salesrepsid;

Q-3	Calculate total order for each customer of each sales person, sorted by customer and 	within each customer by sales person.

select s.name " Sales person",c.company "Customer", count(o.orderid) "Total Orders"
from trainee_35_customer c
inner join trainee_35_salesreps s on c.salesrepsid = s.salesrepsid 
inner join trainee_35_orders o on o.customerid = c.customerid
group by c.customerid;

Q-4	What is the average order size for each sales person whose order total is more than 	amount Rs.30,000/-.

select s.name " Sales person",round(avg(o.qty),2) "average order size"
from trainee_35_orders o
inner join trainee_35_salesreps s on o.salesrepsid = s.salesrepsid
where o.amount >= 30000
group by s.salesrepsid;

Q-5	List all the sales person who are over 40 in age and who manages a sales person whose 	sales are over quota.



select name "Sales person"
from trainee_35_salesreps 
where age > 40 and sales < quota ;

Q-6	List all the customers whose sales people are assign to two different offices in the 	"Eastern" sales region.

select c.company "customer name"
from trainee_35_customer c
inner join trainee_35_salesreps s1 on c.salesrepsid = s1.salesrepsid
inner join trainee_35_office o on s1.officeid = o.officeid
where region = "Eastern"
group by c.company
having count(distinct s1.officeid) >= 2;

select c.company "customer name"
from trainee_35_customer c
inner join trainee_35_salesreps s1 on c.salesrepsid = s1.salesrepsid
inner join trainee_35_office o on s1.officeid = o.officeid
where region = "chani jaghatnaka"
group by c.company
having count(distinct s1.officeid)>=1;


Q-7	List all of the sales persons whose office target sales exceeds the sum of their quota.

select s.name "sales persons"
from trainee_35_salesreps s
inner join trainee_35_office o on s.officeid = o.officeid
group by s.name
having o.targetsales > sum(s.quota);

Q-8	List all the sales people whose average order size for products manufactured by 56 	i.e.(mfrid) is 	higher than the overall average order size.

select s.name " sales People"
from trainee_35_product p 
inner join trainee_35_orders o on p.productid = o.productid
inner join trainee_35_salesreps s on o.salesrepsid = s.salesrepsid
where mfrid = 56 
group by s.name
having avg(o.qty) > (select avg(qty) from trainee_35_orders) ;
